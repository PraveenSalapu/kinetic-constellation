First commit the code changes to github.

Next steps improve current codebase.

Job Site (LinkedIn, Workday, etc.)
â”‚
â”œâ”€ Content Script Injected
â”‚  â”œâ”€ Detects "Apply" button
â”‚  â”œâ”€ Injects floating widget (bottom-right)
â”‚  â””â”€ User clicks widget
â”‚
â”œâ”€ Modal Overlay Opens (on same page)
â”‚  â”œâ”€ Shows: Current profile, Job analysis
â”‚  â”œâ”€ "Auto-Fill" button
â”‚  â””â”€ Real-time progress indicator
â”‚
â””â”€ Auto-Fill Execution
   â”œâ”€ Scrapes job description from page
   â”œâ”€ Sends to backend API (with Bearer token)
   â”œâ”€ Receives tailored resume
   â”œâ”€ Fills form fields one-by-one (visible to user)
   â””â”€ Shows completion status

   ðŸ”§ Revised Technical Architecture
Authentication Flow:
javascript// User logs in (either via web app or extension popup)
// Web app after login:
const response = await fetch('/api/auth/login', { 
  method: 'POST',
  body: JSON.stringify({ email, password })
});

const { token } = await response.json();

// Store token in chrome.storage (accessible everywhere)
chrome.storage.sync.set({ authToken: token });

// Extension uses token for all API calls:
const token = await chrome.storage.sync.get('authToken');
fetch('/api/profiles', {
  headers: { 'Authorization': `Bearer ${token.authToken}` }
});
Benefits:

âœ… Works on any website (no cookie restrictions)
âœ… Syncs across devices (chrome.storage.sync)
âœ… Web app and extension share same token
âœ… No SameSite/CORS cookie issues


UI Injection Pattern:
Instead of side panel:
javascript// content.js - Injected on every page

// 1. Detect if we're on a job application page
if (isJobApplicationPage()) {
  // 2. Inject floating widget
  injectFloatingWidget();
  
  // 3. Listen for widget click
  document.getElementById('careerflow-widget').addEventListener('click', () => {
    // 4. Show modal overlay
    showAutoFillModal();
  });
}

function injectFloatingWidget() {
  const widget = document.createElement('div');
  widget.id = 'careerflow-widget';
  widget.innerHTML = `
    <div style="
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 999999;
      display: flex;
      align-items: center;
      justify-content: center;
    ">
      <svg><!-- Icon --></svg>
    </div>
  `;
  document.body.appendChild(widget);
}

function showAutoFillModal() {
  const modal = document.createElement('div');
  modal.id = 'careerflow-modal';
  modal.innerHTML = `
    <div style="
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1000000;
      display: flex;
      align-items: center;
      justify-content: center;
    ">
      <div style="
        background: white;
        padding: 30px;
        border-radius: 12px;
        max-width: 500px;
        width: 90%;
      ">
        <h2>CareerFlow Auto-Fill</h2>
        <div id="careerflow-content">
          <!-- React app mounts here -->
        </div>
      </div>
    </div>
  `;
  document.body.appendChild(modal);
  
  // Mount React app inside modal
  mountReactApp();
}
```

---

## ðŸ“ Revised Folder Structure
```
/careerflow-monorepo
â”œâ”€â”€ /backend (Node.js + Express)
â”‚   â”œâ”€â”€ server.js
â”‚   â”œâ”€â”€ .env
â”‚   â”œâ”€â”€ /models (User.js, Profile.js, Application.js)
â”‚   â”œâ”€â”€ /routes 
â”‚   â”‚   â”œâ”€â”€ auth.js (JWT-based, no cookies)
â”‚   â”‚   â”œâ”€â”€ profiles.js
â”‚   â”‚   â””â”€â”€ tailor.js
â”‚   â”œâ”€â”€ /middleware
â”‚   â”‚   â””â”€â”€ authenticateToken.js (Bearer token validation)
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ /frontend (React Web App - Vercel)
â”‚   â”œâ”€â”€ /src
â”‚   â”‚   â”œâ”€â”€ /components (Dashboard, ProfileManager)
â”‚   â”‚   â”œâ”€â”€ /pages (Login, Register)
â”‚   â”‚   â””â”€â”€ /utils (API client with token)
â”‚   â””â”€â”€ package.json
â”‚
â””â”€â”€ /extension (Chrome Manifest V3)
    â”œâ”€â”€ manifest.json
    â”œâ”€â”€ /popup (Login UI if not logged in)
    â”‚   â”œâ”€â”€ index.html
    â”‚   â””â”€â”€ popup.js
    â”œâ”€â”€ /content (Injected into job sites)
    â”‚   â”œâ”€â”€ injector.js (Creates widget + modal)
    â”‚   â”œâ”€â”€ formFiller.js (Auto-fill logic)
    â”‚   â”œâ”€â”€ jobScraper.js (Extract job description)
    â”‚   â””â”€â”€ styles.css (Injected styles)
    â”œâ”€â”€ /overlay (React app for modal)
    â”‚   â”œâ”€â”€ OverlayApp.jsx (Mounts inside modal)
    â”‚   â”œâ”€â”€ ProfileSelector.jsx
    â”‚   â”œâ”€â”€ AutoFillStatus.jsx
    â”‚   â””â”€â”€ vite.config.js
    â”œâ”€â”€ /background
    â”‚   â””â”€â”€ service-worker.js (Message passing)
    â””â”€â”€ /utils
        â”œâ”€â”€ apiClient.js (Uses Bearer token)
        â”œâ”€â”€ storageHelper.js (chrome.storage.sync)
        â””â”€â”€ pdfGenerator.js

ðŸ” Revised Auth Flow
Backend Changes:
javascript// routes/auth.js - NO COOKIES

router.post('/login', async (req, res) => {
  const { email, password } = req.body;
  
  const user = await User.findOne({ email });
  if (!user) return res.status(401).json({ error: 'Invalid credentials' });
  
  const valid = await bcrypt.compare(password, user.password);
  if (!valid) return res.status(401).json({ error: 'Invalid credentials' });
  
  // Generate JWT
  const token = jwt.sign(
    { userId: user._id },
    process.env.JWT_SECRET,
    { expiresIn: '7d' }
  );
  
  // Return token in response body (NOT cookie)
  res.json({ 
    success: true, 
    token,
    user: { email: user.email, id: user._id }
  });
});

// middleware/authenticateToken.js
function authenticateToken(req, res, next) {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1]; // Bearer TOKEN
  
  if (!token) return res.status(401).json({ error: 'No token provided' });
  
  jwt.verify(token, process.env.JWT_SECRET, (err, decoded) => {
    if (err) return res.status(403).json({ error: 'Invalid token' });
    req.userId = decoded.userId;
    next();
  });
}
Extension Storage Helper:
javascript// utils/storageHelper.js

export async function saveAuthToken(token) {
  await chrome.storage.sync.set({ authToken: token });
}

export async function getAuthToken() {
  const result = await chrome.storage.sync.get('authToken');
  return result.authToken;
}

export async function clearAuthToken() {
  await chrome.storage.sync.remove('authToken');
}

export async function isLoggedIn() {
  const token = await getAuthToken();
  return !!token;
}
API Client (Works Everywhere):
javascript// utils/apiClient.js

import { getAuthToken } from './storageHelper';

const API_BASE = 'https://api.careerflow.com'; // or localhost:3000

async function fetchWithAuth(endpoint, options = {}) {
  const token = await getAuthToken();
  
  const response = await fetch(`${API_BASE}${endpoint}`, {
    ...options,
    headers: {
      'Content-Type': 'application/json',
      'Authorization': token ? `Bearer ${token}` : '',
      ...options.headers,
    },
  });
  
  if (response.status === 401) {
    // Token expired, redirect to login
    await clearAuthToken();
    throw new Error('Session expired');
  }
  
  return response.json();
}

export const api = {
  login: (email, password) => 
    fetch(`${API_BASE}/api/auth/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    }),
  
  getProfiles: () => fetchWithAuth('/api/profiles'),
  
  tailorResume: (profileId, jobDescription) => 
    fetchWithAuth('/api/tailor', {
      method: 'POST',
      body: JSON.stringify({ profileId, jobDescription })
    }),
};

ðŸŽ¨ Revised UI Flow (JobRight Style)
1. Extension Popup (First Time):
User clicks extension icon â†’ Shows login form if not authenticated
html<!-- popup/index.html -->
<div id="popup-container">
  <div v-if="!isLoggedIn">
    <h2>Login to CareerFlow</h2>
    <input type="email" v-model="email" placeholder="Email">
    <input type="password" v-model="password" placeholder="Password">
    <button @click="login">Login</button>
    <p>Don't have an account? <a href="https://app.careerflow.com/register">Sign up</a></p>
  </div>
  
  <div v-else>
    <h3>Welcome back, {{ user.email }}</h3>
    <p>Navigate to a job posting and click the CareerFlow button</p>
    <button @click="logout">Logout</button>
  </div>
</div>
2. On Job Site (Content Script):
javascript// content/injector.js

(async function() {
  // Check if logged in
  const isLoggedIn = await chrome.storage.sync.get('authToken');
  if (!isLoggedIn.authToken) return;
  
  // Detect job application page
  if (isJobApplicationPage()) {
    injectWidget();
  }
})();

function isJobApplicationPage() {
  const url = window.location.href;
  const keywords = ['apply', 'application', 'job', 'career', 'positions'];
  
  return keywords.some(kw => url.toLowerCase().includes(kw)) ||
         document.querySelector('form[action*="apply"]') !== null;
}

function injectWidget() {
  // Create floating widget (same as before)
  const widget = createWidgetElement();
  document.body.appendChild(widget);
  
  widget.addEventListener('click', async () => {
    // Scrape job description from page
    const jobInfo = scrapeJobInfo();
    
    // Show modal overlay
    showOverlay(jobInfo);
  });
}

function scrapeJobInfo() {
  // Extract job title, company, description
  return {
    title: document.querySelector('h1')?.innerText,
    company: document.querySelector('[data-company]')?.innerText,
    description: document.querySelector('.job-description')?.innerText,
    url: window.location.href
  };
}
3. Modal Overlay (React Component):
jsx// overlay/OverlayApp.jsx

export function OverlayApp({ jobInfo, onClose }) {
  const [profiles, setProfiles] = useState([]);
  const [selectedProfile, setSelectedProfile] = useState(null);
  const [status, setStatus] = useState('idle'); // idle, analyzing, filling, complete
  
  useEffect(() => {
    loadProfiles();
  }, []);
  
  const loadProfiles = async () => {
    const data = await api.getProfiles();
    setProfiles(data.profiles);
    setSelectedProfile(data.profiles[0]); // Default to first
  };
  
  const handleAutoFill = async () => {
    setStatus('analyzing');
    
    // 1. Get tailored resume
    const tailored = await api.tailorResume(
      selectedProfile.id, 
      jobInfo.description
    );
    
    setStatus('filling');
    
    // 2. Fill form fields
    await fillFormFields(tailored.resumeData);
    
    setStatus('complete');
  };
  
  return (
    <div className="careerflow-overlay">
      <div className="modal-content">
        <button onClick={onClose} className="close-btn">Ã—</button>
        
        <h2>Auto-Fill Application</h2>
        
        <div className="job-info">
          <h3>{jobInfo.title}</h3>
          <p>{jobInfo.company}</p>
        </div>
        
        <div className="profile-selector">
          <label>Select Profile:</label>
          <select value={selectedProfile?.id} onChange={e => 
            setSelectedProfile(profiles.find(p => p.id === e.target.value))
          }>
            {profiles.map(p => (
              <option key={p.id} value={p.id}>{p.name}</option>
            ))}
          </select>
        </div>
        
        <button 
          onClick={handleAutoFill} 
          disabled={status !== 'idle'}
          className="auto-fill-btn"
        >
          {status === 'idle' && 'Start Auto-Fill'}
          {status === 'analyzing' && 'Analyzing Job...'}
          {status === 'filling' && 'Filling Form...'}
          {status === 'complete' && 'âœ“ Complete!'}
        </button>
        
        {status === 'filling' && <ProgressIndicator />}
      </div>
    </div>
  );
}

ðŸ”„ Complete Flow Example
Scenario: User Applies to Netflix Job

User visits: https://jobs.netflix.com/jobs/123456
Content script detects job page:

javascript   // content/injector.js runs automatically
   if (isJobApplicationPage()) {
     injectWidget(); // Floating button appears
   }

User clicks floating widget:

javascript   widget.addEventListener('click', () => {
     const jobInfo = scrapeJobInfo(); // Get job description from page
     showOverlay(jobInfo); // Open modal
   });

Modal appears over page:

Shows: "Senior Software Engineer at Netflix"
Profile dropdown: "Backend Java Profile" (selected)
Button: "Start Auto-Fill"


User clicks "Start Auto-Fill":

javascript   async function handleAutoFill() {
     // Get token from storage
     const token = await chrome.storage.sync.get('authToken');
     
     // Call backend
     const response = await fetch('https://api.careerflow.com/api/tailor', {
       method: 'POST',
       headers: {
         'Authorization': `Bearer ${token.authToken}`,
         'Content-Type': 'application/json'
       },
       body: JSON.stringify({
         profileId: 'profile_123',
         jobDescription: jobInfo.description
       })
     });
     
     const { tailoredResume } = await response.json();
     
     // Fill form fields
     fillTextField('input[name="firstName"]', tailoredResume.basics.name.split(' ')[0]);
     fillTextField('input[name="email"]', tailoredResume.basics.email);
     // ... etc
     
     // Upload resume PDF
     uploadResumePDF(tailoredResume);
   }

User watches fields populate in real-time âœ¨
Modal shows: "âœ“ Complete! Review and submit."